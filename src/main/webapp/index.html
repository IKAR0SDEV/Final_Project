<!DOCTYPE html>
<html lang="en">
<head>
    <title>Cartoonify</title>
    <meta charset="utf-8" />
    <link rel='icon' href='Resources/favicon.png' type='image/x-icon'/>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,400i,700,700i&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css.css" type="text/css">
</head>
<body>
<div class="header" id="myHeader">
    <a class="left">Cartoonify</a>
    <a class="right" href="database.html">Database</a>
    <a class="right" href="about.html">About</a>
    <a class="right" href="index.html">Home</a>
</div>

<div class="input">
    <p>Upload Image</p>
    <div class="preview">
        <img id="previewImg" class="previewImg">
    </div>
    <input id="ajaxfile" type="file" accept="image/jpeg, image/png, image/jpg" onchange="showPreview(event)" onclick="hideImg()"/> <br/>
    <button onclick="validateFile(); uploadFile()"> Upload </button>

</div>

<div class="options">
    <div class="slidecontainer">
        <!--<p style="text-align:left">Number Of Colours</p>
        <input type="range" min="1" max="255" value="100" class="slider" id="nColour">
        <p style="text-align:right">Value: <span id="nColourV"></span></p> -->
        <p style="text-align:left">Line Thickness</p>
        <input type="range" min="1" max="10" step="2" value="11" class="slider" id="lineThick">
        <p style="text-align:right">Value: <span id="lineThickV"></span></p>
        <p style="text-align:left">Blur</p>
        <input type="range" min="1" max="100" step="2" value="23" class="slider" id="blur">
        <p style="text-align:right">Value: <span id="blurV"></span></p>
        <p style="text-align:left">Pixelate</p>
        <input type="range" min="1" max="33" step="2" value="5" class="slider" id="pixelate">
        <p style="text-align:right">Value: <span id="pixelateV"></span></p>
    </div>
    <button class="convert">Convert</button>
    <button class="show" onclick="showImage(this);">Show</button>
    <img id="outputPic" src="http://localhost:8080/img/Output.jpg" style="display:none" />
</div>

<div class="output">
    <p>Output Image</p>
    <div class="preview">
        <img id="display-frame" class="display-frame"/>
    </div>
</div>

<!--Show preview image-->
<script type="text/javascript">
    function showPreview(event){
        if(event.target.files.length > 0){
            var src = URL.createObjectURL(event.target.files[0]);
            var preview = document.getElementById("previewImg");
            preview.src = src;
            preview.style.display = "block";
        }
    }
</script>

<!--Get nColour value-->
<!--
<script>
    var sliderC = document.getElementById("nColour");
    var outputC = document.getElementById("nColourV");
    outputC.innerHTML = sliderC.value;

    sliderC.oninput = function() {
        outputC.innerHTML = this.value;
    }
</script>-->
<!--Get lineThick value-->
<script>
    var sliderL = document.getElementById("lineThick");
    var outputL = document.getElementById("lineThickV");
    outputL.innerHTML = sliderL.value;

    sliderL.oninput = function() {
        outputL.innerHTML = this.value;
    }
</script>

<!--Get Blur value-->
<script>
    var sliderB = document.getElementById("blur");
    var outputB = document.getElementById("blurV");
    outputB.innerHTML = sliderB.value;

    sliderB.oninput = function() {
        outputB.innerHTML = this.value;
    }
</script>

<!--Get pixelate value-->
<script>
    var sliderP = document.getElementById("pixelate");
    var outputP = document.getElementById("pixelateV");
    outputP.innerHTML = sliderP.value;

    sliderP.oninput = function() {
        outputP.innerHTML = this.value;
    }
</script>


<!-- Ajax to Java File Upload -->
<script>
    async function uploadFile() {
        let formData = new FormData();
        formData.append("file", ajaxfile.files[0]);
        await fetch('fileuploadservlet', {
            method: "POST",
            body: formData
        });
        alert('The file was uploaded successfully!');
    }
</script>

<!--Validate uploaded image-->
<script type="text/javascript">
    function validateFile() {
        var fileInput = document.getElementById('ajaxfile');
        fileInput.onchange = function () {
            var input = ajaxfile.files[0];
            if (input) {
                //process input.
            } else {
                alert("Please select a file.");
            }
        };
    }
</script>
<!--change image style on button click -->
<script type="text/javascript">
    function showImage(elem) {
        document.getElementById("display-frame").src = elem.nextElementSibling.src;
        document.getElementById("display-frame").style.display = "block";

    }
</script>
<!--Continuously refresh the output image, and on button click display it-->
<script type="text/javascript">
    window.onload = function() {
        var image = document.getElementById("outputPic");

        function updateImage() {
            image.src = image.src.split("?")[0] + "?" + new Date().getTime();
        }

        setInterval(updateImage, 500);
    }
</script>

<!--On upload button click hide preview image-->
<script>
    function hideImg() {
        document.getElementById("display-frame").style.display = "none";
        document.getElementById("previewImg").style.display = "none";
    }
</script>

</body>
</html>
